{"pc":{"type":"Grid","model":{"stacked":"md","rows":[{"cells":[{"component":{"type":"Text","model":{"_internalName":"Text27","text":"<h1 style=\"text-align:center;\">Subcontractor Automation: Correction Forms</h1>"}},"alignment":{"horizontal":"Justify","vertical":"Top"},"columns":{"width":12}}]},{"cells":[{"component":{"type":"SingleLineText","model":{"_internalName":"t.GI.subcontractorName","width":195,"title":{"text":"Subcontractor Name","visible":true},"orientation":"Horizontal","required":false,"font":{"style":"Normal","weight":"Semibold"},"wrap":true,"cFont":{"style":"Normal","weight":"Normal"},"type":"Anything"}},"alignment":{"horizontal":"Justify","vertical":"Top"},"columns":{"width":12}}]},{"cells":[{"component":{"type":"MaskedInput","model":{"_internalName":"mt.GI.contractNo","width":195,"title":{"text":"Contract No.","visible":true},"orientation":"Horizontal","required":false,"font":{"style":"Normal","weight":"Semibold"},"wrap":true,"cFont":{"style":"Normal","weight":"Normal"},"mask":"L-00000"}},"alignment":{"horizontal":"Justify","vertical":"Top"},"columns":{"width":12}}]},{"cells":[{"component":{"type":"DataTable","model":{"_internalName":"DataTable1","title":{"text":"Editable Items","visible":true},"required":false,"font":{"style":"Normal","weight":"Semibold"},"newLine":"Bottom","delete":"Last","columns":[{"_internalName":"Column1","title":"Form Name","required":false,"type":"Dropdown","selection":"Single","allowUserValue":false,"options":"Something went wrong.\nYou should not be seeing this"},{"_internalName":"Column2","title":"Item that requires change","required":false,"type":"Dropdown","selection":"Single","allowUserValue":false,"options":"Something went wrong.\nYou should not be seeing this"},{"_internalName":"Column3","title":"Internal Name","required":false,"type":"String"}]}},"alignment":{"horizontal":"Justify","vertical":"Top"},"columns":{"width":12}}]},{"cells":[{"component":{"type":"DataTable","model":{"_internalName":"dt.email","title":{"text":"Emails","visible":true},"required":false,"font":{"style":"Normal","weight":"Semibold"},"newLine":"Top","delete":"Last","columns":[{"_internalName":"Email","title":"Email","required":false,"type":"String"}]}},"alignment":{"horizontal":"Justify","vertical":"Top"},"columns":{"width":12}}]},{"cells":[{"component":{"type":"Submit","model":{"_internalName":"Submit1","text":"Submit","type":"Primary","click":"return fd.save();"}},"alignment":{"horizontal":"Left","vertical":"Top"},"columns":{"width":12}}]}]}},"tablet":null,"phone":null,"js":"/*\r\n+-------------------------------------------------------------------------------------------------------------------+\r\n|                                                                                                                   |\r\n|column1MTAForms contains the list of drop downs for the first column, which creates a lookup for the second column.|\r\n|                                                                                                                   |\r\n|               The other arrays create a lookup table for third column, which is the internal name                 |\r\n|               of the field that should be corrected when the subcontractor looks at the form again.               |\r\n|                                                                                                                   |\r\n|                                    They are all shown in the following format:                                    |\r\n|                                         [\"Display Name\": \"Internal Name\"]                                         |\r\n|                                                                                                                   |\r\n+-------------------------------------------------------------------------------------------------------------------+\r\n*/\r\n\r\n\r\nGI = {\"Name of Proposed Subcontractor\": \"t.GI.subcontractorName\",\r\n           \"Street Address of Subcontractor\": \"t.GI.streetAddrOfSubContractor\",\r\n            \"City of Subcontractor\": \"t.GI.cityOfSubcontractor\",\r\n            \"State of Subcontractor\": \"dd.GI.stateOfSubcontractor\",\r\n            \"Zip Code of Subcontractor\": \"zipCodeOfSubcontractor\",\r\n            \"Subcontractor Telephone Number\": \"subcontractorTelephoneNumber\",\r\n            \"Subcontractor Fax Number\": \"t.GI.subcontractorFaxNumber\",\r\n            \"Subcontractor EIN\": \"mt.GI.subcontractorEIN\",\r\n            \"Description of Work\": \"n.GI.descriptionOfWork\",\r\n            \"Total Amount of Proposed Subcontract\": \"num.GI.totalAmountOfProposedSubcontract\"\r\n    };\r\nSQS = {\r\n            \"2a: Local Home Address\": \"2a.streetAddr\",\r\n            \"2a: Local Home City\": \"2a.city\",\r\n            \"2a: Local Home State\": \"2a.state\",\r\n            \"2a: Local Zip Code\": \"t.SQS.2a.zipCode\",\r\n            \"3: Are you a corporation or a co-partnership\": \"sc.SQS.3.corpOrCoPartner\",\r\n            \"3 (Corporation) - Incorporation Date\": \"d.SQS.3.incorporationDate\",\r\n            \"3 (Corporation) - Presidents Name\": \"t.SQS.3.president'sName\",\r\n            \"3 (Corporation) - VP's Name\": \"t.SQS.3.vicePresident'sName\",\r\n            \"3 (Corporation) - Treasurer's Name\": \"t.SQS.3.treasurer'sName\", \r\n            \"3 (Corporation) - Secretary's Name\": \"t.SQS.3.secretary'sName\",\r\n            \"3 (Co-Partnership) - Date of Organization\": \"d.SQS.3.dateOfOrg\",\r\n            \"3 (Co-Partnership) - County Papers are filed in\": \"t.SQS.3.county\",\r\n            \"3 (Co-Partnership) - Names and Address of Partners\": \"dt.SQS.3.namesAndAddrsOfPartners\",\r\n            \"6: D/M/WBE requirements of contract\": \"sc.isProposedSupplierDMWBE\",\r\n            \"7: How many years as a contractor?\": \"num.SQS.7.yrsExpAsContractor\",\r\n            \"7: How many years as a subcontractor?\": \"num.SQS.7.yrsExpAsSubcontractor\",\r\n            \"8: Previous expereince of directing officers\": \"dt.SQS.8.prevExp\",\r\n            \"9: Principal contracts completed\": \"dt.SQS.9.principalContracts\",\r\n            \"10: Contracts that the present organization has on hand\": \"dt.SQS.10.contractsOnHand\",\r\n            \"11: References\": \"dt.SQS.11.refs\",\r\n            \"12: Labor Employed Through\": \"dt.SQS.11.refs\",\r\n            \"12: Union Name\": \"t.SQS.12.unionName\",\r\n            \"12: Union Address\": \"t.SQS.12.addr\",\r\n            \"12: Union Local No\": \"t.SQS.12.localNo\",\r\n            \"12: Union Tele\": \"t.SQS.12.telephone\"\r\n\r\n};\r\n\r\nSF = {\r\n    \"Is Schedule F3 applicable?\": \"sc.SF.FF3.FF3Applicable\",\r\n    \"1: Type of Federal Action\": \"sc.SF.FF3.1.typeOfFederalAction\",\r\n    \"2: Status of Federal Action\": \"sc.SF.FF3.2.statusOfFederalAction\",\r\n    \"3: Report Type\": \"sc.SF.FF3.3.reportType\",\r\n    \"3b: Material Change Year\": \"t.SF.FF3.3.yr\",\r\n    \"3b: Material Change Quarter\": \"t.SF.FF3.3.quarter\",\r\n    \"3b: Material Change Date of Last Report\": \"t.SF.FF3.3.date\",\r\n    \"4: Name and Address of Reporting Entity\": \"sc.SF.FF3.4.primeOrSubawardee\",\r\n    \"4: Subawardee Tier\": \"t.SF.FF3.4.tier\",\r\n    \"4: Name of Reporting Entity\": \"t.SF.FF3.4.nameOfReportingEntity\",\r\n    \"4: Address of Reporting Entity\": \"\"\r\n};\r\n\r\nSF1 = {\r\n    \"6: List active contracts that are running concurrently\": \"dt.SF1.6.activeContracts\"\r\n};\r\n\r\nRMSA = {\r\n    \"Is RMSA required?\": \"sc.RMSA.isRequired\",\r\n    \"Material Description\": \"n.RMSA.materialDescription\",\r\n    \"Supplier Name\": \"t.RMSA.Supplier.name\",\r\n    \"Supplier Street Address\": \"t.RMSA.Supplier.streetAddr\",\r\n    \"Supplier City\": \"t.RMSA.Supplier.city\",\r\n    \"Supplier State\": \"dd.RMSA.Supplier.state\",\r\n    \"Supplier Zip Code\": \"t.RMSA.Supplier.zipCode\",\r\n    \"Supplier Phone Number\": \"t.RMSA.Supplier.phoneNumber\",\r\n    \"Local Manufacturing Facility Street Address\": \"t.RMSA.localManufacturingFacility.streetAddr\",\r\n    \"Local Manufacturing Facility City\": \"t.RMSA.localManufacturingFacility.city\",\r\n    \"Local Manufacturing Facility State\": \"ddi.RMSA.localManufacturingFacility.state\",\r\n    \"Local Manufacturing Facility Zip Code\": \"t.RMSA.localManufacturingFacility.zipCode\",\r\n    \"D/M/WBE requirements of contract\": \"sc.isProposedSupplierDMWBE\",\r\n    \"Cost of Materials\": \"num.RMSA.costOfMaterials\",\r\n    \"References\": \"dt.RMSA.refs\"\r\n};\r\n\r\nSBP1 = {\"A. Contractor's Full Legal Name\": \"t.SB.P1.A.contractorsFullLegalName\",\r\n        \"B. Contractor's Mailing Address\": \"t.SB.P1.B.contractorsMailingAddress\",\r\n        \"C. Contractor's Street Address\": \"t.SB.P1.C.streetAddress\",\r\n        \"D. Prior Addresses\": \"n.SB.P1.D.changedAddress\",\r\n        \"E. Primary Point of Contact Name\": \"t.SB.P1.E.primaryContactName\",\r\n        \"E. Primary Point of Contact Email\": \"t.SB.P1.E.primaryContactEmail\",\r\n        \"E. Primary Point of Contact Tele\": \"t.SB.P1.E.primaryContactTelephoneNumber\",\r\n        \"F. Contractor's EIN\": \"mt.SB.P1.F.contractorEIN\",\r\n        \"G. Type of Legal Entity\": \"t.SB.P1.G.typeOfLegalEntity\",\r\n        \"G. Name of Partner 1\": \"t.SB.P1.G.1.partnerPartyName\",\r\n        \"G. TIN/EIN/SSN of Partner 1\": \"t.SB.P1.G.1.TINEINSSN\",\r\n        \"G. % ownership of Partner 1\": \"num.SB.P1.G.1.percentageOfOwnership\",\r\n        \"G. Name of Partner 2\": \"t.SB.P1.G2.partnerPartyName\",\r\n        \"G. TIN/EIN/SSN of Partner 2\": \"t.SB.P1.G.2.TINEINSSN\",\r\n        \"G. % ownership of Partner 2\": \"num.SB.P1.G.2.percentageOfOwnership\",\r\n        \"G. Name of Partner 3\": \"t.SB.P1.G.3.partnerPartyName\",\r\n        \"G. TIN/EIN/SSN of Partner 3\": \"t.SB.P1.G.3.TINEINSSN\",\r\n        \"G. % ownership of Partner 3\": \"num.SB.P1.G.3.percentageOfOwnership\",\r\n        \"H. Year contractor was organzied\": \"num.SB.P1.H.yearOfOrganization\",\r\n        \"H. State contractor was organized\": \"t.SB.P1.H.stateOfOrganization\",\r\n        \"H. If organized under foreign country\": \"t.SB.P1.H.country\",\r\n        \"I. DBA Names\": \"t.SB.P1.I.DBA\"\r\n    };\r\nSBP2 = {\"A. Name of Person Completing Form\": \"t.SB.P2.A.name\",\r\n        \"B. Employer/Title\": \"t.P2.B.employerTitle\",\r\n        \"C. Office Number\": \"t.SB.P2.C.officeNumber\",\r\n        \"C. Mobile Number\": \"t.SB.P2.C.mobileNumber\",\r\n        \"D. Email Address\": \"t.SB.P2.D.email\"};\r\nSBP3 = {\"A. Has contractor been declared not responsible?\": \"sc.SB.P3.A.notResponsible\",\r\n        \"B. Has the contractor been debarred, suspended, or disqualified?\": \"sc.SB.P3.B.debarred\",\r\n        \"C. Is there a proceeding pending against the contractor?\": \"sc.SB.P3.C.pendingDebarment\",\r\n        \"D. Has contractor defaulted or terminated on a contract?\": \"sc.SB.P3.D.terminated\",\r\n        \"E. Entity requested enforcement of its rights under a surety agreement?\": \"sc.SB.P3.E.suretyAgreement\",\r\n        \"F. Has Contractor been required to engage the services of a monitor?\": \"sc.SB.P3.F.monitor\",\r\n        \"G. Has Contractor's safety practices been evaluated as less than satisfactory?\": \"sc.SB.P3.G.safety\",\r\n        \"H. Compensation Experience rating of 1.2 or greater?\": \"sc.SB.P3.H.compensationRating\",\r\n        \"Please Explain why you have answered YES\": \"sc.SB.P3.seperateSheet\",\r\n        \"Any seperate PDF Attachments\": \"a.SB.P3.attachments\"};\r\nSBP4 = {\"Please attach a complete organizational chart\": \"a.SB.P4.completeOrganizationChart\",\r\n        \"A. Has contractor been convicted or pleaded nolo contendere?\": \"sc.SB.P4.A.noloContendere\",\r\n        \"B. Contractor has pending the commission of a crime (Unfavorable termination)?\": \"sc.SB.P4.B.unfavorableTerminated\",\r\n        \"C. Subject of investigation in connection to commision of a crime\": \"sc.SB.P4.C.subjectOfCrime\",\r\n        \"D. Disqualified from bidding for any government entity\": \"sc.SB.P4.D.disqualifiedBid\",\r\n        \"E. Has Contractor refused testimony\": \"sc.SB.P4.E.refuseTestimony\",\r\n        \"F. Has contractor refused testimony in NYS?\": \"sc.SB.P4.F.refuseTestimonyNYS\",\r\n        \"G. Has contractor been convicted of a civil judgement?\": \"sc.SB.P4.G.civilJudgement\",\r\n        \"H. Has contractor entered into a deferred prosecution agreement?\": \"sc.SB.P4.H.deferredProsecution\",\r\n        \"Explain any YES in Part 4\": \"t.SB.P4.yesToAnyAnswerExplain\",\r\n        \"Attach any required documents\": \"a.SB.P4.relevantInformation\"\r\n};\r\nSBP5 = {\"A. Name, Title, Home, and Business Address of entities that hold more than 10%\": \"dt.SB.P5.A.10orMoreOwnership\",\r\n        \"B. Name, Title, Home, and Business Address of directors and principal officers\": \"dt.SB.P5.B.directorsAndPrincipalOfficersOfContractor\",\r\n        \"C. Has contractor been a subcontractor on any conctractor with the MTA\": \"sc.SB.P5.C.subcontractor\",\r\n        \"C. If yes, provide contracto number and description\": \"dt.SB.P5.C.pastThreeYrs\",\r\n        \"D. Has the contractor filed for bankruptcy protection?\": \"sc.SB.P5.D.bankruptcy\",\r\n        \"E. Are there any judgements, injuctions, or liens against contractor by a government entity\": \"sc.SB.P5.E.liensExcess\",\r\n        \"F. Are there any judgements against contractor that are unsatisfactory?\": \"sc.SB.P5.F.liensToday\",\r\n        \"G. Has contractor failed to file or been delinquent on any tax return?\": \"sc.SB.P5.G.failedTax\",\r\n        \"H. Does Contractor rent or own office space?\": \"sc.SB.P5.H.officeSpace\",\r\n        \"H. Provide details\": \"n.SB.P5.H.officeSpaceDetails\",\r\n        \"I. Is there any conflict of interest in real estate?\": \"sc.SB.P5.I.conflictOfInterest\",\r\n        \"J. Does contactor share office space eith any entities?\": \"sc.SB.P5.J.sharedOffice\",\r\n        \"J. Please Explain your shared office space\": \"n.SB.P5.J.sharedOfficeExplanation\",\r\n        \"K1. If the answer is none\": \"sc.SB.P5.K.1.none\",\r\n        \"K1a. Brief description of work\": \"n.SB.P5.K.1.a.descOfWork\",\r\n        \"K1a. Contract Number\": \"t.SB.P5.K.1.a.contractNumber\",\r\n        \"K1a. Dollar amount of award\": \"num.SB.P5.K.1.a.dollarAmtOfAward\",\r\n        \"K1a. Date Completed\": \"d.SB.P5.K.1.a.dateCompleted\",\r\n        \"K1a. Dollar amount at completion\": \"num.SB.P5.K.1.a.dollarAmtAtCompletion\",\r\n        \"K1a. Name of Company and Owners Representative\": \"t.SB.P5.K.1.a.name\",\r\n        \"K1a. Telephone of Company and Owner's Representative\": \"t.SB.P5.K.1.a.telephone\",\r\n        \"K1b. Brief description of work\": \"n.SB.P5.K.1.b.descOfWork\",\r\n        \"K1b. Contract Number\": \"t.SB.P5.K.1.bcontractNumber\",\r\n        \"K1b. Dollar amount of award\": \"num.SB.P5.K.1.bdollarAmtOfAward\",\r\n        \"K1b. Date Completed\": \"d.SB.P5.K.1.bdateCompleted\",\r\n        \"K1b. Dollar amount at completion\": \"num.SB.P5.K.1.bdollarAmtAtCompletion\",\r\n        \"K1b. Name of Company and Owners Representative\": \"t.SB.P5.K.1.bname\",\r\n        \"K1b. Telephone of Company and Owner's Representative\": \"t.SB.P5.K.1.btelephone\",\r\n        \"K1c. Brief description of work\": \"n.SB.P5.K.1.c.descOfWork\",\r\n        \"K1c. Contract Number\": \"t.SB.P5.K.1.c.contractNumber\",\r\n        \"K1c. Dollar amount of award\": \"num.SB.P5.K.1.c.dollarAmtOfAward\",\r\n        \"K1c. Date Completed\": \"d.SB.P5.K.1.c.dateCompleted\",\r\n        \"K1c. Dollar amount at completion\": \"num.SB.P5.K.1.c.dollarAmtAtCompletion\",\r\n        \"K1c. Name of Company and Owners Representative\": \"t.SB.P5.K.1.c.name\",\r\n        \"K1c. Telephone of Company and Owner's Representative\": \"t.SB.P5.K.1.c.telephone\",\r\n        \"K2. If the answer is None\": \"sc.SB.P5.K.2.none\",\r\n        \"K2. Each contract for which liquidated damages or penalties were asserted\": \"dt.SB.P5.K.2.last3YrsPenalities\",\r\n        \"K3. If Answer is none\": \"sc.SB.P5.K.3.none\",\r\n        \"K3. Has contractor been awarded any MTA contracts where work has not reached substantial completion\": \"dt.SB.P5.K.2.last3YrsPenalities\",\r\n        \"K4. If answer is none\": \"sc.SB.P5.K.4.none\",\r\n        \"K4. Any active contracts where work is managed by the same office that manages its contracts with MTA\": \"sc.SB.P5.K.4.none\",\r\n        \"K5. If answer is none\": \"sc.SB.P5.K.5.none\",\r\n        \"K5. Subcontractor on MTA contracts that have not reached substantial completion\": \"sc.SB.P5.K.5.none\",\r\n        \"L. If none of the sitations have occurred\": \"sc.SB.P5.L.none\",\r\n        \"L. Furnish the following info for each contract for which the contractor was\": \"dt.SB.P5.L.contractSituations\",\r\n        \"M. If none, click none\": \"sc.SB.P5.M.none\",\r\n        \"M. List all employees who are currently employees of the MTA\": \"dt.SB.P5.M.employeesOfMTA\",\r\n        \"N. Affiliate companies in a direct line of report\": \"sc.SB.P5.N.haveSubsidiaryOrAffiliate\",\r\n        \"O. Is contractor a subsidiary of another entity\": \"sc.SB.P5.O.isContractorSubsidiaryOfGroup\",\r\n        \"P. Does any entity with more than 10%+ interest have 10%+ interest in any other entity?\": \"sc.SB.P5.P.ownershipOfOtherEntity\",\r\n        \"Q. If the answer to N, O, or P is yes, would the answer also be yes for other subsidiary?\": \"sc.SB.P5.Q.sameBusinessGroup\",\r\n        \"Q. Please attach your explanation\": \"n.SB.P5.Q.explanation\"\r\n    };\r\nSBP6 = {\"Owners or Partners of contractor\": \"dt.SB.P6.ownerAndPartners\"};\r\n\r\nSB1 = {\r\n    \"Do you require Schedule B1?\": \"sc.SB1.isSB1Required\",\r\n    \"1. Technical Explanation\": \"n.SB1.1.explanation\",\r\n    \"1a. See Section\": \"t.SB1.1.seeSection\",\r\n    \"2. Licenses\": \"dt.SB1.2.licenses\",\r\n    \"3. License revoked in the past 3 years?\": \"n.SB1.3.explanationOfSuspendedLicensesPermitsOrCertifications\",\r\n    \"4. Performance Bond Information\": \"dt.SB1.4.performanceBondInfo\",\r\n    \"5. Subcontracts\": \"dt.SB1.5.subcontracts\",\r\n    \"6. Prior MTA Employees\": \"dt.SB1.6.priorMTAEmployees\"\r\n};\r\n\r\nOCIPA = {\r\n    \"Section 1 - Contact Name\": \"t.OCIP.FA.S1.contact\",\r\n    \"Section 1 - Contact Email\": \"t.OCIP.FA.S1.email\",\r\n    \"Section 1 - EMR\": \"num.OCIP.FA.S1.EMR\",\r\n    \"Section 1 - Contract/Bid type\": \"mc.OCIP.FA.S1.contractBid\",\r\n    \"Section 1 - Estimated Start Date\": \"d.OCIP.FA.S1.estimatedStartDate\",\r\n    \"Section 1 - Estimated Completion Date\": \"d.OCIP.FA.S1.estimatedCompletionDate\",\r\n    \"Section 1 - Who are you contracted with?\": \"t.OCIP.FA.S1.whoAreYouContractedWith\",\r\n    \"Section 1 - Are you subcontracting any work?\": \"sc.OCIP.FA.S1.areYouSubcontractingOutAnyWork\",\r\n    \"Section 2 - Worker's Comp Carrier\": \"t.OCIP.FA.S2.workersCompCarrier\",\r\n    \"Section 2 - Worker's Comp Policy Number\": \"t.OCIP.FA.S2.workersCompPolicyNumber\",\r\n    \"Section 2 - Worker's Comp Effective\": \"mt.OCIP.FA.S2.workersCompEffective\",\r\n    \"Section 2 - Worker's Comp Expiration\": \"mt.OCIP.FA.S2.workersCompExpiration\",\r\n    \"Section 2 - Rating Board File Num\": \"t.OCIP.FA.S2.ratingBoardFileNumber\",\r\n    \"Section 2 - Rating Date\": \"d.OCIP.FA.S2.ratingDate\",\r\n    \"Section 2 - General Liability Carrier\": \"t.OCIP.FA.S2.yourGeneralLiabilityCarrier\",\r\n    \"Section 2 - Auto Liability Carrier\": \"t.OCIP.FA.S2.yourAutomobileLiabilityCarrier\",\r\n    \"Section 2 - Excess Liability Carrier\": \"t.OCIP.FA.S2.yourExcessLiabilityCarrier\",\r\n    \"Section 2 - Broker Name\": \"t.OCIP.FA.S2.insuranceAgentBrokerName\",\r\n    \"Section 2 - Broker Address\": \"t.OCIP.FA.S2.insuranceAgentBrokerAddr\",\r\n    \"Section 2 - Broker Contact\": \"t.OCIP.FA.S2.insuranceAgentBrokerContact\",\r\n    \"Section 2 - Broker Phone\": \"t.OCIP.FA.S2.insuranceAgentBrokerPhone\",\r\n    \"Section 2 - Date Prepared\": \"d.OCIP.FA.S2.datePrepared\",\r\n    \"Section 2 - Fax\": \"t.OCIP.FA.S2.insuranceAgentBrokerFax\",\r\n    \"Section 2 - Print\": \"t.OCIP.FA.S2.printName\",\r\n    \"Section 2 - Date\": \"d.OCIP.FA.S2.date\",\r\n    \"Section 2 - Title\": \"t.OCIP.FA.S2.title\"\r\n};\r\n\r\nOCIPB = {\r\n    \"Section 1 - Gross Contract Value (Including Insurance)\": \"num.OCIP.FB.S1.grossContractValue\",\r\n    \"Section 1 - New Contract Value (Excluding Insurance)\": \"num.OCIP.FB.S1.netContractValue\",\r\n    \"Section 1 - Estimate Limited Payroll\": \"num.OCIP.FB.S1.estimatedLimitedPayroll\",\r\n    \"Section 1 - Estimated Unlimited Payroll\": \"num.OCIP.FB.S1.estimatedUnlimitedPayroll\",\r\n    \"Section 1 - Workers Compensation Deductible\": \"num.OCIP.FB.S1.workersCompensationDeductibleAmount\",\r\n    \"Section 1 - General Liability Deductible\": \"num.OCIP.FB.S1.generalLiabilityDeductibleAmount\",\r\n    \"Section 2 - Calculate your insurance premium\": \"dt.OCIP.FB.S2.insurancePremium\",\r\n    \"Section 2 - Total Manual Premium\": \"num.OCIP.FB.S2.totalManualPremium\",\r\n    \"Section 2 - Experience Mod\": \"num.OCIP.FB.S2.experienceMod\",\r\n    \"Section 2 - Modified Premium\": \"num.OCIP.FB.S2.modifiedPremium\",\r\n    \"Section 2 - Description 1\": \"t.OCIP.FB.S2.description1\",\r\n    \"Section 2 - Description 2\": \"t.OCIP.FB.S2.description2\",\r\n    \"Section 2 - Description 3\": \"t.OCIP.FB.S2.description3\",\r\n    \"Section 2 - Description 4\": \"t.OCIP.FB.S2.description4\",\r\n    \"Section 2 - +/- 1\": \"dd.OCIP.FB.S2.plusOrMinus1\",\r\n    \"Section 2 - +/- 2\": \"dd.OCIP.FB.S2.plusOrMinus2\",\r\n    \"Section 2 - +/- 3\": \"dd.OCIP.FB.S2.plusOrMinus3\",\r\n    \"Section 2 - +/- 4\": \"dd.OCIP.FB.S2.plusOrMinus4\",\r\n    \"Section 2 - Rate 1\": \"num.OCIP.FB.S2.rate1\",\r\n    \"Section 2 - Rate 2\": \"num.OCIP.FB.S2.rate2\",\r\n    \"Section 2 - Rate 3\": \"num.OCIP.FB.S2.rate3\",\r\n    \"Section 2 - Rate 4\": \"num.OCIP.FB.S2.rate4\",\r\n    \"Section 2 - Modified $1\": \"num.OCIP.FB.S2.modified1\",\r\n    \"Section 2 - Modified $2\": \"num.OCIP.FB.S2.modified2\",\r\n    \"Section 2 - Modified $3\": \"num.OCIP.FB.S2.modified3\",\r\n    \"Section 2 - Modified $4\": \"num.OCIP.FB.S2.modified4\",\r\n    \"Section 2 - Running Total 1\": \"num.OCIP.FB.S2.runningTotal1\",\r\n    \"Section 2 - Running Total 2\": \"num.OCIP.FB.S2.runningTotal2\",\r\n    \"Section 2 - Running Total 3\": \"num.OCIP.FB.S2.runningTotal3\",\r\n    \"Section 2 - Running Total 4\": \"num.OCIP.FB.S2.runningTotal4\",\r\n    \"Section 2 - Total WC Premium\": \"num.OCIP.FB.S2.totalWCPremium\",\r\n    \"Section 2 - General Liability Rate\": \"num.OCIP.FB.S2.generalLiability.currentRate\",\r\n    \"Section 2 - General Liability Factor\": \"num.OCIP.FB.S2.generalLiability.factor\",\r\n    \"Section 2 - General Liability Unlimited Payroll\":\"num.OCIP.FB.S2.generalLiability.unlimitedPayrollOrReceipts\",\r\n    \"Section 2 - General Liability Premium\": \"num.OCIP.FB.S2.generalLiability.premium\",\r\n    \"Section 2 - Excess Liability Rate\": \"num.OCIP.FB.S2.excessLiability.currentRate\",\r\n    \"Section 2 - Excess Liability Factor\": \"num.OCIP.FB.S2.excessLiability.factor\",\r\n    \"Section 2 - Excess Liability Unlimited Payroll\":\"num.OCIP.FB.S2.excessLiability.unlimitedPayrollOrReceipts\",\r\n    \"Section 2 - Excess Liability Premium\": \"num.OCIP.FB.S2.excessLiability.premium\",\r\n    \"Section 2 - Overhead and Profit\": \"num.OCIP.FB.S2.overheadAndProfit\",\r\n    \"Section 2 - Total Estimated Insurance\": \"num.OCIP.FB.S2.totalEstimatedInsuranceCost\",\r\n    \"Section 2 - Date\": \"d.OCIP.FB.S2.date\",\r\n    \"Section 2 - Print\": \"t.OCIP.FB.S2.printName\",\r\n    \"Section 2 - Title\": \"t.OCIP.FB.S2.title\"\r\n\r\n};\r\nOCIPCOI = {\r\n    \"Certificate Upload\": \"a.OCIP.COI.upload\"\r\n}\r\ncolumn1MTAForms = {\"General Information\": GI,\r\n                        \"SQS\": SQS,\r\n                        \"Schedule F\": SF,\r\n                        \"Schedule F1\": SF1,\r\n                        \"Request for Material Supplier Approval\": RMSA,\r\n                        \"Schedule B Part 1\": SBP1,\r\n                        \"Schedule B Part 2\": SBP2,\r\n                        \"Schedule B Part 3\": SBP3,\r\n                        \"Schedule B Part 4\": SBP4,\r\n                        \"Schedule B Part 5\": SBP5,\r\n                        \"Schedule B Part 6\": SBP6,\r\n                        \"Schedule B1\": SB1,\r\n                        \"OCIP Form A\": OCIPA,\r\n                        \"OCIP Form B\": OCIPB,\r\n                        \"OCIP COI\": OCIPCOI\r\n};\r\n\r\n\r\n/*\r\n+-------------------------------------------------------------------------------------------------------------+\r\n|                                                                                                             |\r\n|                         fd.rendered gets run once the form is completely rendered.                          |\r\n|                    The functions inside are responsible for updating what the user sees                     |\r\n|                                          upon something updating.                                           |\r\n|                                                                                                             |\r\n|        $on('edit'...) will change the dropdowns on Column1 and Column2 upon clicking the dropdowns.         |\r\n|                                                                                                             |\r\n|$on('change'...) will update the rightmost column with the internal name once the dropdown has been selected.|\r\n|                                                                                                             |\r\n+-------------------------------------------------------------------------------------------------------------+\r\n*/\r\nfd.rendered(function() {\r\n    disableLastColumn();\r\n    //Everytime the datatable is edited, it will update the drop downs with the correct infomration\r\n    fd.control('DataTable1').$on('edit', function(e) {\r\n        //console.log(e);\r\n        if (e.column.field === 'Column1') {\r\n            populateColumn(e.widget, e.model.Column1, column1MTAForms);\r\n        }\r\n        if (e.column.field === 'Column2') {\r\n            populateColumn(e.widget, e.model.Column2, column1MTAForms[e.model.Column1]);\r\n        }\r\n    });\r\n    \r\n    //Everytime the datatable is edited, it will update the third dropdwon \r\n    fd.control('DataTable1').$on('change', function(value) {\r\n        for (var i = 0; i < value.length; i++) {\r\n            //console.log(value);\r\n            try{\r\n            value[i].set('Column3', column1MTAForms[value[i].Column1][value[i].Column2]); \r\n            } catch {\r\n                console.log(column1MTAForms[value[i].Column1]);\r\n            }\r\n        }\r\n        console.log(checkColumn3Filled());\r\n    });\r\n});\r\n/*\r\n+-------------------------------------------------------------------------------------------------------------------------+\r\n|                                                                                                                         |\r\n|                     Before saving, we need to check to make sure nothing is missing from the form.                      |\r\n|                   That is: there are no \"undefined\"s in column 3, where the internal name should be.                    |\r\n|                         If that function fails, throw an error and disallow the user to submit.                         |\r\n|                                                                                                                         |\r\n|      Once we know that the form is good to go, we need to compose the JSON to be sent to the Power Automate step.       |\r\n|                                                                                                                         |\r\n|                             Power Automate expects the 5 essential pieces of information.                               |\r\n|                                                  1. Subcontractor Name                                                  |\r\n|                                                   2. Contract Number                                                    |\r\n|3. Body of email (An array of the specified changes, to be added to the email) [It was simpler in JS than Power Automate]|\r\n|      4. editableItems (An array of internal names that should be edited. This will be inserted into the JSON file)      |\r\n|                        5. email (An array of emails addresses whom the email should be sent to)                         |\r\n|                                                                                                                         |\r\n+-------------------------------------------------------------------------------------------------------------------------+\r\n*/\r\nfd.beforeSave(function() {\r\n    if (checkColumn3Filled()) {\r\n        console.log(checkColumn3Filled());\r\n        throw new Error(\"Your form is not completed - there are still missing components\");\r\n    }\r\n    \r\n    url = \"https://prod-76.westus.logic.azure.com:443/workflows/34545c436ff04f18a535e11258c53ad7/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=QaY6UKMxwRLFyre2HKECVA9N8c_3k2WYfX5ZuYYngrg\";\r\n    formData = fd.data();\r\n    dataToSend = {};\r\n    dataToSend[\"t.GI.subcontractorName\"] = formData[\"t.GI.subcontractorName\"];\r\n    dataToSend[\"mt.GI.contractNo\"] = formData[\"mt.GI.contractNo\"];\r\n    console.log(dataToSend);\r\n    \r\n    formToCorrect = extractData(\"DataTable1\", \"Column1\");\r\n    questionsToCorrect = extractData(\"DataTable1\", \"Column2\");\r\n\r\n    bodyOfEmail = [];\r\n    emptyString = \"\";\r\n    for (var i = 0; i < formToCorrect.length; i++) {\r\n        bodyOfEmail.push(formToCorrect[i].concat(' - ',questionsToCorrect[i]));\r\n        //console.log(bodyOfEmail);\r\n    }\r\n    dataToSend.bodyOfEmail = bodyOfEmail;\r\n    dataToSend.editableItems = extractData(\"DataTable1\", \"Column3\");\r\n    \r\n    \r\n    dataToSend.email = extractData(\"dt.email\", \"Email\");\r\n    console.log(dataToSend);\r\n    \r\n    interactWithAPI(dataToSend, url);\r\n    throw new Error(\"Preventing you from submitting\");\r\n});\r\n/*\r\n+-----------------------------------------------------------------------------------------------+\r\n|                                                                                               |\r\n|This function will extract all the values in a column in a data table and return it as an array|\r\n|                                                                                               |\r\n+-----------------------------------------------------------------------------------------------+\r\n*/\r\nfunction extractData(dt, col) {\r\n    returnArray = [];\r\n    \r\n    fd.control(dt).value.forEach(row => {\r\n        returnArray.push(row[col]);\r\n    });\r\n    return returnArray;\r\n}\r\n/*\r\n+-------------------------------------------------------------------------------------------+\r\n|                                                                                           |\r\n|      This function will send the data provided to the url provided as POST request.       |\r\n|I chose POST over GET since a body with information could be included at all times in POST.|\r\n|                                                                                           |\r\n+-------------------------------------------------------------------------------------------+\r\n*/\r\nfunction interactWithAPI(data, url) {\r\n    const headers = {\r\n      'Content-Type': 'application/json'\r\n    };\r\n  \r\n    const options = {\r\n      method: 'POST',\r\n      headers: headers,\r\n      body: JSON.stringify(data)\r\n    };\r\n  \r\n    return fetch(url, options)\r\n      .then(response => {\r\n        if (response.ok) {\r\n          return response.json();\r\n        } else {\r\n          throw new Error('Error: ' + response.status);\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.error('Error:', error);\r\n      });\r\n}\r\n\r\n/*\r\n+--------------------------------------------------------------------------------------------------------+\r\n|                                                                                                        |\r\n|                 This function, checkColumn3Filled(), iterates through the data table                   |\r\n|\"DataTable1\" and counts the number of rows where the value in \"Column3\" is undefined (i.e., not filled).|\r\n|                                                                                                        |\r\n|                 returns {number} The count of rows with undefined values in \"Column3\".                 |\r\n|                                                                                                        |\r\n|                                                                                                        |\r\n+--------------------------------------------------------------------------------------------------------+\r\n*/\r\nfunction checkColumn3Filled() {\r\n    //This function should loop through the data table and return 1 if the column something is undefined (ie. not filled)\r\n    //Thus, lets count the number of undefineds. If it exceeds 1, then we have an empty row, and we should return the number of undefineds. Otherwise, return 0\r\n    var i = 0;\r\n    fd.control(\"DataTable1\").value.forEach(row => {\r\n        if (row.Column3 === undefined) {\r\n            i++;\r\n        }\r\n    });\r\n    return i;\r\n}\r\n\r\n/*\r\n+---------------------------------------------------------------------------------------------------------------+\r\n|                                                                                                               |\r\n|This helper function, populateColumn(), is designed to populate the dropdown of a specific cell in a datatable.|\r\n|                                                                                                               |\r\n|                    @param {any} widget - The widget (dropdown) to be populated with data.                     |\r\n|                                                                                                               |\r\n|           @param {any} value - The value to be selected in the dropdown (if it exists in the data).           |\r\n|                                                                                                               |\r\n|          @param {Array} arrayName - The array containing the data to populate the dropdown options.           |\r\n|                                                                                                               |\r\n|                           @returns {void} This function does not return any value.                            |\r\n|                                                                                                               |\r\n+---------------------------------------------------------------------------------------------------------------+\r\n*/\r\nfunction populateColumn(widget, value, arrayName) {\r\n    widget.setDataSource({\r\n        data: Object.keys(arrayName)\r\n    });\r\n    widget.value(value);\r\n}\r\n\r\n/*\r\n+-------------------------------------------------------------------------------------+\r\n|                                                                                     |\r\n|               This function, disableLastColumn(), is used to disable                |\r\n|the editing capability of the last column ('Column3') in the data table \"DataTable1\".|\r\n|                                                                                     |\r\n|              @returns {void} This function does not return any value.               |\r\n|                                                                                     |\r\n+-------------------------------------------------------------------------------------+\r\n*/\r\nfunction disableLastColumn() {\r\n    const premiumColumn = fd.control(\"DataTable1\").columns.find(c => c.field === 'Column3');\r\n    premiumColumn.editable = () => false;\r\n}\r\n","css":"h1 {\n    text-align: center; \n font-family: Times New Roman; \n font-size: min(6.5vw 2.34375rem) !important;\n}","notifySubscribers":true,"version":"1.0.2","theme":null,"timezone":"America/New_York","culture":"en-US","thankYouMessage":null,"redirectURL":null,"hideAfterSubmission":false,"submissionTimeout":0,"authentication":0,"singleSubmissionPerUser":false,"allowEditingSubmission":false,"restrictAccess":false,"azureADTenant":null,"azureADObjects":[],"azureB2CProperties":null}