---
title: "API: Correction Submission"
layout: page
nav_order: 6
parent: The Power Automate Flows
grand_parent: Technical Specifications
---

# Correction Submission
{: .no_toc}

## Table of Contents
{: .no_toc}

1. Table of Contents
{:toc}

## Purpose

Once the [correction form] is submitted, it will send an API POST request to this flow. The POST request will contain an object with data from the form, which will be parsed. The file indicated by the `contract number` and `subcontractor name` combo specified the file that needs to be edited. It functions in the following way:

1. An HTTP POST request is parsed for data, getting the data ready to be maniupulated.

2. The email body, an array pregenerated by the JavaScript contains an array of the corresponding items to be corrected, is parsed and appended with `<br>` in the HTML to create a better looking email. 

3. The file specified by `contract number` and `subcontractor name` combo is retrieved and the removeal of the `editableItems` property is attempted.

4. Whether or not the above action succeeds, the the pregenerated array `editableItems` is then added back as a property. This updates what items can be changed.

5. The file is overwritten with this new data.

6. An email is sent back to the contacts listed, informing them of the need to correct their information. The note from the POST request is also included.

## Flow Diagram

![Power Automate Flow for Subcontractor Autofill API]({{ site.baseurl }}/assets/images/powerAutomate/apiCorrection.png)

## Connections, Triggers, and Actions Used

**Trigger:** [When HTTP Request is recieved](https://learn.microsoft.com/en-us/azure/connectors/connectors-native-reqres)

|Connector|Action|
|:-:|:-:|
|[Data Operation](https://learn.microsoft.com/en-us/power-automate/data-operations) | Parse JSON|
|[SharePoint](https://learn.microsoft.com/en-us/connectors/sharepointonline/)| Get Files (Properties Only)|
|[HTTPS call](https://learn.microsoft.com/en-us/azure/connectors/connectors-native-reqres)|When a HTTP request is recieved <br> Response|

----
[correction form]: https://tce-innovation.github.io/Subcontractor-Automation/forms/correction.html